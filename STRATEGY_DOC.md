# Strategy Document: Lot-Based Cycle Trading (STRATEGY_DOC.md)

## 1. Summary

This trading strategy moves away from the traditional "single position" mindset, where all shares of a stock are viewed as one averaged block. Instead, it treats every transaction as a discrete **Trading Lot** that must be opened and closed individually. By enforcing a strict 1:1 link between purchases and sales, the strategy ensures total clarity on the success or failure of every market entry.

## 2. Goal & Purpose

* **Precise Profit Attribution:** To know exactly how much profit or loss was generated by a specific entry at a specific price.
* **Strategic Discipline:** To prevent "holding and hoping" by requiring a clear exit for every lot entered.
* **Cycle Transparency:** To visualize the duration and efficiency of each trade from start to finish.
* **Enhanced Averaging:** To use grouping (batching) to understand the combined performance of multiple related trades without losing the underlying data of individual lots.

## 3. Trading Strategy

### 3.1 Lot Entry

* **Discrete Acquisition:** Every buy order executed in the brokerage is recorded as a unique "Lot" in the system.
* **Lot Sizing:** The size of each buy lot is worth Rs. 5000. Number of units of that ticker is determined by the Current Market Price (CMP) of that ticker.
* **Buy Conditions:** - Will buy the lots on the below conditions.
* When there zero lots present of a particular ticker, will buy irrespective of price or whenever the price change on that day is negative
* Will buy when the CMP is lower than the last buy
* Will buy when the average buy price of open lots (that are not sold yet) that ticker


### 3.2 Lot Exit

* **1:1 Matching Requirement:** A sell transaction is only initiated to close one specific, corresponding buy lot.
* **No Partial Selling:** A sell order must equal the exact quantity of the buy lot it is paired with.
* **Cycle Closure:** Once a sell is recorded and linked via the `parent_buy_id`, the associated buy lot is marked as "Closed".
* **Sell Conditions:** - Will sell the lots on the below conditions.
* Sell a lot if the CMP is more than 3% of the buy price of that lot
* Sell all the lots (latest bought lots) that have reached more than 3% profit individually or overall 3% profit
* If we have held a lot for a long period (20 days or more), we will try to sell that lot (mostly the earliest bought open lot) along with other lots (latest bought lots) with a net profit (not necessarily 3% profit overall). 


### 3.3 Overall buy and sell considerations - Apart from considering individual ticker, we will consider below conditions
* Try to buy at least one and at most 5 lots, one lot of a specific ticker. If many tickers are in negative CMP due to overall bearish market.
* Number of lots bought on a given day depends on how many tickers have reached buy condition individually
* Similary try to sell all lots or batches of a given ticker that reached 3% target. 
* Total number of tickers of whose lots we are selling is not more than 5. This happens when overall bullish market.
* We tend to buy a lot of a ticker even with very less negative CMP in a bullish market.
* We tend to sell at a lesser profit in a bearish market.
* If we buy many lots of a specific ticker in short number of days, would buy only if there is a huge dip in price or after some days 
* Number of lots bought or sold on a given day will also depend on the funds available to buy in my brokerage account   


## 4. Batching for Averaging & Profit Tracking

### 4.1 "Synthetic" Averaging

* **The Batch Concept:** While individual lots maintain their own cost basis, they are grouped into a **Batch** to view an aggregate performance.
* **Weighted Average:** The system calculates a weighted average cost and average exit price for the entire batch, providing a high-level view of a "strategy cycle" while preserving individual lot history.
* **Weighted Average:** The ultimate goal is that each batch has net profit overall. Individual lot in a batch might be sold at loss, but on aggregate it will be positive.



### 4.2 Profit Tracking & Analysis

* **Batch-Level P&L:** Total realized profit is calculated at the batch level by summing the gains of all 1:1 pairs within that group.
* **Strategy Evaluation:** Batching allows the trader to group trades and clear up the lots that were held for long period. Purpose of batching is to achieve faster money rotation and selling at no loss. 
* **Efficiency Metrics:** By analyzing batches, the trader can determine the average time-to-exit for a series of related trades.


